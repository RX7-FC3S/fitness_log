import{c as V,e as Y,u as A,r as _,A as k,o as F,f as T,g as d,h as B,i as w,j as t,F as f,k as v,m as S,a as M,p as N,q as l,s as y,v as h,t as n,x as U,y as C,z,d as E,_ as G}from"./index-Bbbvtfa9.js";const P=V("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),q={class:"logs-page"},I={class:"form-group"},O={class:"filter-grid"},R={class:"form-group no-mb"},H={class:"form-group no-mb"},J={class:"scroll-area",id:"logs-list"},K={class:"day-header"},Q={class:"day-date f-title"},W={class:"day-stats"},X={class:"exercise-name-header"},Z={class:"sets-list"},$={class:"set-main-info"},ee={class:"set-index"},se={class:"set-data"},te={class:"unit-text"},ae={key:0,class:"set-remark"},oe={key:0,class:"empty-state"},re=Y({__name:"Logs",setup(ne){const u=A();E();const p=_([]),c=_({from_date:k().subtract(3,"month").format("YYYY-MM-DD"),to_date:k().format("YYYY-MM-DD"),exercise_name:""}),g=_(!1),x=async()=>{p.value=await M.getLogs(c.value)},D=a=>{if(!a||a.length===0)return[];const e={};return a.forEach(s=>{const r=typeof s.exercise=="object"?s.exercise.name:String(s.exercise||"未知动作");e[r]||(e[r]=[]),e[r].push(s)}),Object.entries(e).sort(([,s],[,r])=>{const o=new Date(s[0]?.createdAt||0).getTime(),m=new Date(r[0]?.createdAt||0).getTime();return o-m}).map(([s,r])=>({name:s,sets:[...r].sort((o,m)=>new Date(o.createdAt||0).getTime()-new Date(m.createdAt||0).getTime())}))},b=a=>{const e=u.setTypes.find(s=>s.value===a)?.label||a;let i="badge-working";return a.includes("热身")&&(i="badge-warmup"),a.includes("失败")&&(i="badge-failure"),a.includes("递减")&&(i="badge-drop"),{label:e,class:i}},j=async()=>{g.value=!0;try{await x()}finally{g.value=!1}},L=a=>a?new Set(a.map(e=>typeof e.exercise=="object"?e.exercise.name:String(e.exercise))).size:0;return F(async()=>{u.setPageTitle("训练日志"),u.setFooterVisible(!0),u.setPageFooter([{key:"refresh",label:"筛选历史记录",variant:"primary",class:"flex-1",icon:P,onClick:j,loading:g}]),await x(),u.hideLoading()}),T(()=>{u.clearPageFooter()}),(a,e)=>{const i=N("FCard");return l(),d("div",q,[B(i,{variant:"header",class:"header-card"},{default:w(()=>[t("div",I,[y(t("input",{type:"text",class:"form-input",placeholder:"搜索动作...","onUpdate:modelValue":e[0]||(e[0]=s=>c.value.exercise_name=s)},null,512),[[h,c.value.exercise_name]])]),t("div",O,[t("div",R,[e[3]||(e[3]=t("label",{class:"form-label"},"开始日期",-1)),y(t("input",{type:"date",class:"form-input","onUpdate:modelValue":e[1]||(e[1]=s=>c.value.from_date=s)},null,512),[[h,c.value.from_date]])]),t("div",H,[e[4]||(e[4]=t("label",{class:"form-label"},"结束日期",-1)),y(t("input",{type:"date",class:"form-input","onUpdate:modelValue":e[2]||(e[2]=s=>c.value.to_date=s)},null,512),[[h,c.value.to_date]])])])]),_:1}),t("div",J,[(l(!0),d(f,null,v(p.value,s=>(l(),d("div",{key:s.date,class:"log-day-section"},[t("div",K,[t("h3",Q,n(s.date),1),t("span",W,n(L(s.sets))+" 动作 | "+n((s.sets||[]).length)+" 组 ",1)]),(l(!0),d(f,null,v(D(s.sets||[]),r=>(l(),U(i,{key:r.name,padding:"0",margin:"0 0 1rem 0","border-radius":"0.75rem","no-shadow":"",class:"exercise-log-card"},{default:w(()=>[t("div",X,n(r.name),1),t("div",Z,[(l(!0),d(f,null,v(r.sets,(o,m)=>(l(),d("div",{key:m,class:"set-row"},[t("div",$,[t("span",ee,n(m+1),1),t("span",se,[C(n(o.weight),1),t("span",te,n(typeof o.unit=="object"?o.unit.name:o.unit),1),e[5]||(e[5]=t("span",{class:"multiply-sign"},"×",-1)),C(" "+n(o.reps),1),e[6]||(e[6]=t("span",{class:"unit-text"},"次",-1))]),t("span",{class:z(["set-type-badge",b(String(o.setType)).class,"small-badge"])},n(b(String(o.setType)).label),3)]),o.remark?(l(),d("div",ae,n(o.remark),1)):S("",!0)]))),128))])]),_:2},1024))),128))]))),128)),p.value.length===0?(l(),d("div",oe,"没有找到相关记录")):S("",!0)])])}}}),ie=G(re,[["__scopeId","data-v-a53389a0"]]);export{ie as default};
